<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tokens Manager</title>
</head>
<body>
  <div class="tabs">
    <button class="tab active" data-tab="table">Table</button>
    <button class="tab" data-tab="json">JSON</button>
  </div>

  <!-- Table Tab -->
  <div id="table-tab" class="tab-content active">
    <div class="toolbar">
      <div class="toolbar-group">
        <select id="collection-select" class="collection-select"></select>
        <button id="add-collection-btn" class="btn btn-icon" title="New Collection">
          <span class="icon" data-icon="plus"></span>
        </button>
      </div>

      <div class="toolbar-divider"></div>

      <div class="toolbar-group">
        <button id="add-variable-btn" class="btn btn-primary">
          <span class="icon" data-icon="plus"></span>
          Add Variable
        </button>
        <button id="shades-btn" class="btn" title="Generate Color Shades">
          <span class="icon" data-icon="shades"></span>
          Shades
        </button>
        <button id="steps-btn" class="btn" title="Generate Number Steps">
          <span class="icon" data-icon="steps"></span>
          Steps
        </button>
      </div>

      <div class="spacer"></div>

      <div class="search-wrapper">
        <span class="search-icon" data-icon="search"></span>
        <input type="text" id="search-input" class="search-input" placeholder="Search...">
        <span id="search-count" class="search-count"></span>
      </div>

      <span id="status" class="status"></span>

      <button id="refresh-btn" class="btn btn-icon" title="Refresh">
        <span class="icon" data-icon="refresh"></span>
      </button>
      <button id="expand-btn" class="btn btn-icon" title="Expand">
        <span class="icon" data-icon="expand"></span>
      </button>
    </div>

    <div class="table-container">
      <table class="spreadsheet">
        <thead>
          <tr>
            <th class="col-name">Name</th>
            <th class="col-value">Value</th>
            <th class="col-actions">Actions</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>

    <!-- Add Menu -->
    <div id="add-menu" class="add-menu">
      <button data-type="COLOR"><span class="icon" data-icon="type-COLOR"></span>Color</button>
      <button data-type="FLOAT"><span class="icon" data-icon="type-FLOAT"></span>Number</button>
      <button data-type="STRING"><span class="icon" data-icon="type-STRING"></span>String</button>
      <button data-type="BOOLEAN"><span class="icon" data-icon="type-BOOLEAN"></span>Boolean</button>
    </div>

    <!-- Color Value Menu -->
    <div id="color-value-menu" class="color-value-menu">
      <button data-action="pick"><span class="icon" data-icon="shades"></span>Pick Color</button>
      <button data-action="reference"><span class="icon" data-icon="type-COLOR"></span>Reference Color</button>
    </div>
  </div>

  <!-- JSON Tab -->
  <div id="json-tab" class="tab-content">
    <div class="json-panel">
      <textarea id="json-editor" class="json-editor" spellcheck="false"></textarea>
      <div style="display:flex;gap:8px;">
        <button id="json-update-btn" class="btn btn-primary">Update</button>
        <button id="json-format-btn" class="btn">Format</button>
      </div>
    </div>
  </div>

  <!-- Shades Generator Modal -->
  <div id="shades-modal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3>Generate Color Shades</h3>
        <button class="modal-close" onclick="window.app.closeShadesModal()">
          <span class="icon" data-icon="close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Select Color</label>
          <select id="shades-source" class="form-input" onchange="window.app.selectSourceColor()">
            <option value="">-- Select a color --</option>
          </select>
        </div>

        <div id="shades-options" style="display:none;flex-direction:column;gap:16px;">
          <div class="form-group">
            <label>Group Name</label>
            <input type="text" id="shades-name" class="form-input" placeholder="e.g. blue, primary, brand" value="">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Base Color</label>
              <div class="color-input-wrapper">
                <div class="color-input-preview" onclick="window.app.openShadesColorPicker()" style="cursor:pointer;">
                  <div class="color-fill" id="shades-base-preview" style="background: transparent"></div>
                </div>
                <input type="hidden" id="shades-base-color" value="">
                <input type="text" id="shades-base-hex" class="form-input mono" value="" placeholder="#000000" oninput="window.app.updateBaseFromHex()">
              </div>
            </div>
            <div class="form-group">
              <label>Shades</label>
              <input type="number" id="shades-count" class="form-input" value="11" min="2" max="20" oninput="window.app.updateShadesPreview()" style="width:60px;">
            </div>
          </div>

          <div class="form-group">
            <label>
              <span>Preview</span>
              <select id="shades-curve-property" class="curve-property-select" onchange="window.app.updateCurveEditor()">
                <option value="lightness" selected>Lightness</option>
                <option value="saturation">Saturation</option>
                <option value="hue">Hue</option>
              </select>
            </label>
            <div class="curve-preview-combined" id="shades-curve-editor">
              <svg class="curve-svg" id="shades-curve-svg"></svg>
              <div class="shades-preview" id="shades-preview"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="shades-remove-btn" class="btn btn-danger" onclick="window.app.removeShades()" style="display:none;">Remove Shades</button>
        <div class="spacer"></div>
        <button class="btn" onclick="window.app.closeShadesModal()">Cancel</button>
        <button id="shades-generate-btn" class="btn btn-primary" onclick="window.app.generateShades()">Generate</button>
      </div>
    </div>
  </div>

  <!-- Input Modal -->
  <div id="input-modal" class="modal-overlay">
    <div class="modal" style="width: 300px;">
      <div class="modal-header">
        <h3 id="input-modal-title">Enter Name</h3>
        <button class="modal-close" onclick="window.app.closeInputModal()">
          <span class="icon" data-icon="close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label id="input-modal-label">Name</label>
          <input type="text" id="input-modal-input" class="form-input" placeholder="Enter name...">
          <select id="input-modal-select" class="form-input" style="display:none;"></select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" onclick="window.app.closeInputModal()">Cancel</button>
        <button id="input-modal-confirm" class="btn btn-primary">Create</button>
      </div>
    </div>
  </div>

  <!-- Color Picker Modal -->
  <div id="color-picker-modal" class="modal-overlay">
    <div class="modal" style="width: 300px;">
      <div class="modal-header">
        <h3>Pick Color</h3>
        <button class="modal-close" onclick="window.app.closeColorPicker()">
          <span class="icon" data-icon="close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="color-picker-container">
          <div id="sv-panel" class="picker-sv-panel">
            <div id="sv-handle" class="picker-sv-handle"></div>
          </div>
          <div id="hue-slider" class="picker-hue-slider">
            <div id="hue-handle" class="picker-hue-handle"></div>
          </div>
          <div class="color-picker-inputs">
            <input type="text" id="picker-hex-input" class="form-input" placeholder="#000000">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" onclick="window.app.closeColorPicker()">Cancel</button>
        <button class="btn btn-primary" onclick="window.app.confirmColorPicker()">Apply</button>
      </div>
    </div>
  </div>

  <!-- Color Reference Modal -->
  <div id="color-reference-modal" class="modal-overlay">
    <div class="modal" style="width: 360px;">
      <div class="modal-header">
        <h3>Reference Color</h3>
        <button class="modal-close" onclick="window.app.closeColorReferenceModal()">
          <span class="icon" data-icon="close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Select a color variable</label>
          <input type="text" id="color-reference-search" class="form-input" placeholder="Search colors..." oninput="window.app.filterColorReferences(this.value)" onkeydown="window.app.handleColorReferenceSearchKey(event)">
        </div>
        <div id="color-reference-list" class="color-reference-list"></div>
      </div>
      <div class="modal-footer">
        <button class="btn" onclick="window.app.closeColorReferenceModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Steps Generator Modal -->
  <div id="steps-modal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3>Generate Number Steps</h3>
        <button class="modal-close" onclick="window.app.closeStepsModal()">
          <span class="icon" data-icon="close"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Select Number Variable</label>
          <select id="steps-source" class="form-input" onchange="window.app.selectSourceNumber()">
            <option value="">-- Select a number --</option>
          </select>
        </div>

        <div id="steps-options" style="display:none;flex-direction:column;gap:16px;">
          <div class="form-group">
            <label>Group Name</label>
            <input type="text" id="steps-name" class="form-input" placeholder="e.g. spacing" value="">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Base Value</label>
              <input type="number" id="steps-base-value" class="form-input" value="16" min="0" step="any" oninput="window.app.updateStepsPreview()">
            </div>
            <div class="form-group">
              <label>Base Step</label>
              <select id="steps-base-step" class="form-input" onchange="window.app.onBaseStepChange()"></select>
            </div>
          </div>

          <div class="form-group">
            <label>Scale Ratio</label>
            <div class="form-row">
              <select id="steps-ratio-preset" class="form-input" onchange="window.app.selectRatioPreset()">
                <option value="1.125">Minor Second (1.125)</option>
                <option value="1.2">Minor Third (1.2)</option>
                <option value="1.25" selected>Major Third (1.25)</option>
                <option value="1.333">Perfect Fourth (1.333)</option>
                <option value="1.414">Augmented Fourth (1.414)</option>
                <option value="1.5">Perfect Fifth (1.5)</option>
                <option value="1.618">Golden Ratio (1.618)</option>
                <option value="2">Octave (2)</option>
                <option value="custom">Custom...</option>
              </select>
              <input type="number" id="steps-ratio-custom" class="form-input" value="1.25" min="1" step="0.001" oninput="window.app.updateStepsPreview()" style="width:80px;" disabled>
            </div>
          </div>

          <div class="form-group">
            <label>Steps</label>
            <div class="form-row">
              <select id="steps-list-preset" class="form-input" onchange="window.app.selectStepsPreset()">
                <option value="tshirt">T-shirt (xs-3xl)</option>
                <option value="numeric">Numeric (1-10)</option>
                <option value="gutenberg">Gutenberg (xs-ultra)</option>
                <option value="custom">Custom...</option>
              </select>
            </div>
            <input type="text" id="steps-list" class="form-input mono" value="xs, sm, md, lg, xl, 2xl, 3xl" oninput="window.app.onStepsListInput()" style="margin-top:6px;">
          </div>

          <div class="form-group">
            <label>Preview</label>
            <div class="steps-preview" id="steps-preview"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="steps-remove-btn" class="btn btn-danger" onclick="window.app.removeSteps()" style="display:none;">Remove Steps</button>
        <div class="spacer"></div>
        <button class="btn" onclick="window.app.closeStepsModal()">Cancel</button>
        <button id="steps-generate-btn" class="btn btn-primary" onclick="window.app.generateSteps()">Generate</button>
      </div>
    </div>
  </div>

  <!-- Resize Handles -->
  <div class="resize-handle resize-handle--top" data-resize="top"></div>
  <div class="resize-handle resize-handle--right" data-resize="right"></div>
  <div class="resize-handle resize-handle--bottom" data-resize="bottom"></div>
  <div class="resize-handle resize-handle--left" data-resize="left"></div>
  <div class="resize-handle resize-handle--corner" data-resize="corner"></div>

  <script type="module" src="./main.ts"></script>
</body>
</html>
